window.egretAnimate||(window.egretAnimate={Rectangle:egret.Rectangle,Tween:createjs.Tween,Ease:createjs.Ease,fps:24}),function(window){var utils={};utils.addImages=function(atlas){var id;for(var frame in atlas.textures)id=frame.substring(0,frame.indexOf(".")),window.pixiflash_images[id]=atlas.textures[frame]},utils.colorToHex=function(color){return/^rgba\(/.test(color)?(color=color.substring(5,color.length-1).split(","),color=65536*parseInt(color[0])+256*parseInt(color[1])+parseInt(color[2])):color=parseInt(color.replace(/^#/,""),16),color},egretAnimate.utils=utils}(window),function(undefined){var Point=egret.Point,ColorFilter=egretAnimate.ColorFilter,uniqueId=0,DisplayObject=function(){this.id=++uniqueId,this._isEgretAnimate=!0,this.skew=new Point,this._rotation=0,this._srB=0,this._srC=0,this._crA=1,this._crD=1,this._cachedRotY=0,this._cachedRotX=0,this.tickEnabled=!0,this.boundMaskChanged=!1,this._lastComputedTint=this._lastSelfTint=this._lastParentTint=this._selfTint=16777215,this.__filters=null},p=DisplayObject.prototype,DEG_TO_RAD=Math.PI/180,RAD_TO_DEG=180/Math.PI,PI_2=2*Math.PI;Object.defineProperties(p,{_filters:{enumerable:!0,get:function(){return this.__filters},set:function(value){if(value)if(1==value.length&&value[0]instanceof ColorFilter&&value[0].isTintOnly)this.tint=value[0].tint,this.__filters=null;else{this.__filters=[];for(var i=0;i<value.length;++i)value[i]instanceof ColorFilter&&value[i].isTintOnly?this.tint=value[i].tint:this.__filters.push(value[i])}else this.__filters=null}},tint:{enumerable:!0,get:function(){var parent=this.parent;if(parent&&parent._isEgretAnimate){var selfTint=this._selfTint,parentTint=parent.tint;if(16777215==selfTint)this._lastComputedTint=parentTint;else if(16777215==parentTint)this._lastComputedTint=selfTint;else if(selfTint!=this._lastSelfTint||parentTint!=this._lastParentTint){var max=255,parentR=parentTint>>16&255,parentG=parentTint>>8&255,parentB=255&parentTint,selfR=selfTint>>16&255,selfG=selfTint>>8&255,selfB=255&selfTint;this._lastComputedTint=Math.round(parentR*selfR/max)<<16|Math.round(parentG*selfG/max)<<8|Math.round(parentB*selfB/max)}return this._lastSelfTint=selfTint,this._lastParentTint=parentTint,this._lastComputedTint}return this._selfTint},set:function(value){this._selfTint=value}},skewX:{enumerable:!0,get:function(){return this.skew.x*RAD_TO_DEG},set:function(value){this.skew.x=value*DEG_TO_RAD}},skewY:{enumerable:!0,get:function(){return this.skew.y*RAD_TO_DEG},set:function(value){this.skew.y=value*DEG_TO_RAD}},regX:{enumerable:!0,get:function(){return this.anchorOffsetX},set:function(value){this.anchorOffsetX=value}},regY:{enumerable:!0,get:function(){return this.anchorOffsetY},set:function(value){this.anchorOffsetY=value}},mask:{enumerable:!0,get:function(){return this._mask},set:function(mask){var _maskShape=this._maskShape;_maskShape&&mask!=_maskShape&&(--_maskShape._maskUses<1&&_maskShape.parent&&_maskShape.parent.removeChild(_maskShape),_maskShape.off("graphicsChanged",this.onShapeChanged)),this._mask&&(this._mask.renderable=!0),mask&&mask instanceof egretAnimate.Shape?(this.boundMaskChanged||(this.boundMaskChanged=!0,this.onShapeChanged=this.onShapeChanged.bind(this),this.onAddedWithMask=this.onAddedWithMask.bind(this)),_maskShape!=mask&&(_maskShape=this._maskShape=mask,++_maskShape._maskUses,_maskShape.on("graphicsChanged",this.onShapeChanged)),mask.graphics.graphicsData.length?this._mask=mask.graphics:this._mask=null):this._mask=mask,mask||this._hasAddedEvent&&(this.off("added",this.onAddedWithMask),this._hasAddedEvent=!1),this._mask&&(this.parent?mask.parent!=this.parent&&this.parent.addChild(mask):this._hasAddedEvent||(this._hasAddedEvent=!0,this.once("added",this.onAddedWithMask)),this._mask.renderable=!1)}}}),p.onAddedWithMask=function(){if(this._mask){var mask=this._maskShape||this._mask;mask.parent!=this.parent&&this.parent.addChild(mask)}},p.cache=function(){},p.onShapeChanged=function(shape){this.mask=shape},p.displayObjectUpdateTransform=function(){var a,b,c,d,tx,ty,pt=this.parent.worldTransform,wt=this.worldTransform,scale=this.scale,skew=this.skew,position=this.position,pivot=this.pivot,rotY=this._rotation+skew.y,rotX=this._rotation+skew.x;rotY%PI_2||rotX%PI_2?(rotX===this._cachedRotX&&rotY===this._cachedRotY||(this._cachedRotX=rotX,this._cachedRotY=rotY,this._crA=Math.cos(rotY),this._srB=Math.sin(rotY),this._srC=Math.sin(-rotX),this._crD=Math.cos(rotX)),a=this._crA*scale.x,b=this._srB*scale.x,c=this._srC*scale.y,d=this._crD*scale.y,tx=position.x,ty=position.y,(pivot.x||pivot.y)&&(tx-=pivot.x*a+pivot.y*c,ty-=pivot.x*b+pivot.y*d),wt.a=a*pt.a+b*pt.c,wt.b=a*pt.b+b*pt.d,wt.c=c*pt.a+d*pt.c,wt.d=c*pt.b+d*pt.d,wt.tx=tx*pt.a+ty*pt.c+pt.tx,wt.ty=tx*pt.b+ty*pt.d+pt.ty):(a=scale.x,d=scale.y,tx=position.x-pivot.x*a,ty=position.y-pivot.y*d,wt.a=a*pt.a,wt.b=a*pt.b,wt.c=d*pt.c,wt.d=d*pt.d,wt.tx=tx*pt.a+ty*pt.c+pt.tx,wt.ty=tx*pt.b+ty*pt.d+pt.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},p.setTransform=function(x,y,scaleX,scaleY,rotation,skewX,skewY,regX,regY){return this.x=x||0,this.y=y||0,this.scaleX=null==scaleX?1:scaleX,this.scaleY=null==scaleY?1:scaleY,this.rotation=rotation||0,this.skewX=skewX||0,this.skewY=skewY||0,this.regX=regX||0,this.regY=regY||0,this},DisplayObject.mixin=function(targetPrototype){for(var prop in p){var propDesc=Object.getOwnPropertyDescriptor(p,prop);propDesc?Object.defineProperty(targetPrototype,prop,propDesc):targetPrototype[prop]=p[prop]}},egretAnimate.DisplayObject=DisplayObject}(),function(undefined){var EgretContainer=egret.DisplayObjectContainer,DisplayObject=egretAnimate.DisplayObject,ticker=egret.Ticker.getInstance(),DisplayObjectContainer=function(){EgretContainer.call(this),DisplayObject.call(this),this.tickChildren=!0,this.once(egret.Event.ADDED,function(){this._onAdded(),this.addEventListener(egret.Event.ADDED,this._onAdded,this),this.addEventListener(egret.Event.REMOVED,this._onRemoved,this)},this)},s=EgretContainer.prototype,p=DisplayObjectContainer.prototype=Object.create(s);DisplayObject.mixin(p),p.initialize=DisplayObjectContainer,p.__Container_addChild=p.addChild,p.addChild=function(child){for(var i=0;i<arguments.length;i++)this.__Container_addChild(arguments[i])},p._onAdded=function(){this.parent._isEgretAnimate||ticker.register(this._tickListener,this)},p._tickListener=function(tickerDeltaTime){var ms=tickerDeltaTime/60/egretAnimate.TARGET_FPMS;this._tick(ms)},p._onRemoved=function(){this._tickListener&&ticker.unregister(this._tickListener,this)},p._tick=p.Container__tick=function(delta){if(this.tickChildren)for(var i=this.children.length-1;i>=0;i--){var child=this.children[i];child.tickEnabled&&child._tick?child._tick(delta):child.tickChildren&&child.Container__tick&&child.Container__tick(delta)}},p.__Container_destroy=p.destroy,p.destroy=function(destroyChildren){this._tickListener&&(ticker.unregister(this._tickListener,this),this._tickListener=null),this.__Container_destroy(destroyChildren)},egretAnimate.Container=DisplayObjectContainer}(),function(undefined){var EgretBitmap=egret.Bitmap,DisplayObject=egretAnimate.DisplayObject,Bitmap=function(image){EgretBitmap.call(this,image),DisplayObject.call(this)},p=Bitmap.prototype=Object.create(EgretBitmap.prototype);DisplayObject.mixin(p),p.initialize=Bitmap,egretAnimate.Bitmap=Bitmap}(),function(undefined){var EgretGraphics=egret.Graphics,utils=egretAnimate.utils,DisplayObject=egretAnimate.DisplayObject,Graphics=function(){EgretGraphics.call(this),DisplayObject.call(this)},s=EgretGraphics.prototype,p=Graphics.prototype=Object.create(s);DisplayObject.mixin(p),p.initialize=Graphics,egretAnimate.Graphics=Graphics;var BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63};p.mt=p.moveTo,p.lt=function(x,y){return this.op().lineTo(x,y)},p.bt=function(cp1x,cp1y,cp2x,cp2y,x,y){return this.op().bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)},p.dr=p.r=p.drawRect,p.rr=p.drawRoundedRect,p.rc=function(x,y,w,h,radiusTL,radiusTR,radiusBR,radiusBL){return DEBUG&&console.warn("Complex rounded rectangles not supported"),this.rr(x,y,w,h,radiusTL)},p.dc=p.drawCircle,p.a=function(x,y,radius,startAngle,endAngle,anticlockwise){return this.op().arc(x,y,radius,startAngle,endAngle,anticlockwise)},p.at=function(x1,y1,x2,y2,radius){return this.op().arcTo(x1,y1,x2,y2,radius)},p.de=function(x,y,width,height){return this.drawEllipse(x+width/2,y+height/2,width/2,height/2)},p.qt=function(cpx,cpy,x,y){return this.op().curveTo(cpx,cpy,x,y)},p.cp=function(){var currentPath=this.currentPath;return currentPath&&currentPath.shape&&(currentPath.shape.closed=!0),this},p.op=function(){var currentPath=this.currentPath;return currentPath&&currentPath.shape&&(currentPath.shape.closed=!1),this},p.f=function(color){if(color){var rgb=utils.colorToHex(color),a=alphaFromColor(color);this.beginFill(rgb,a)}else this.beginFill(0,0);return this},p.lf=function(colors,ratios,x0,y0,x1,y1){var alphas=colors.map(function(color){return alphaFromColor(color)});colors=colors.map(function(color){return utils.colorToHex(color)});var matrix=new egret.Matrix(1,x0/819.2,1,y0/819.2);return this.beginGradientFill(egret.GradientType.LINEAR,colors,alphas,ratios.map(function(ratio){return 255*ratio}),matrix),this},p.rf=function(colors,ratios,x0,y0,x1,y1){var alphas=colors.map(function(color){return alphaFromColor(color)});colors=colors.map(function(color){return utils.colorToHex(color)});var matrix=new egret.Matrix(1,x0/819.2,1,y0/819.2);return this.beginGradientFill(egret.GradientType.RADIAL,colors,alphas,ratios.map(function(ratio){return 255*ratio}),matrix),this},p.bf=function(){return DEBUG&&console.warn("Bitmap fills are not supported"),this.f("#000000")},p.sd=function(){return DEBUG&&console.warn("Dashed strokes are not supported"),this},p.bs=function(){return DEBUG&&console.warn("Bitmap strokes are not supported"),this},p.ls=function(){return DEBUG&&console.warn("Linear gradient strokes are not supported"),this},p.rs=function(){return DEBUG&&console.warn("Radial gradient strokes are not supported"),this},p.ss=function(thickness,caps,joints,miterLimit,ignoreScale){return this.lineWidth=thickness,this.lineStyle(this.lineWidth,this.lineColor,this.lineAlpha,ignoreScale,"normal",caps,joints,miterLimit),this},p.s=function(color){return color&&(this.lineColor=utils.colorToHex(color),this.lineAlpha=1),this},p.p=function(str){for(var instructions=[this.mt,this.lt,this.qt,this.bt,this.cp],paramCount=[2,2,4,6,0],i=0,l=str.length,params=[],x=0,y=0,base64=BASE_64;i<l;){var c=str.charAt(i),n=base64[c],fi=n>>3,f=instructions[fi];if(!f||3&n)throw"bad path data (@"+i+"): "+c;var pl=paramCount[fi];fi||(x=y=0),params.length=0,i++;for(var charCount=(n>>2&1)+2,p=0;p<pl;p++){var num=base64[str.charAt(i)],sign=num>>5?-1:1;num=(31&num)<<6|base64[str.charAt(i+1)],3==charCount&&(num=num<<6|base64[str.charAt(i+2)]),num=sign*num/10,p%2?x=num+=x:y=num+=y,params[p]=num,i+=charCount}f.apply(this,params)}return this};var alphaFromColor=function(color){return/^rgba\(/.test(color)?parseFloat(color.substring(color.lastIndexOf(",")+1,color.lastIndexOf(")"))):1}}(),function(undefined){function MovieClipPlugin(){throw"MovieClipPlugin cannot be instantiated."}var Container=egret.DisplayObjectContainer,DisplayObject=egretAnimate.DisplayObject,Timeline=createjs.Timeline,Tween=createjs.Tween,ticker=egret.Ticker.getInstance(),MovieClip=function(mode,startPosition,loop,labels){MovieClip.inited||MovieClip.init(),Container.call(this),DisplayObject.call(this),this.tickChildren=!0,this.mode=mode||MovieClip.INDEPENDENT,this.startPosition=startPosition||0,this.loop=loop,this.currentFrame=0,this.timeline=new Timeline(null,labels,{paused:!0,position:startPosition,useTicks:!0}),this.paused=!1,this.actionsEnabled=!0,this.autoReset=!0,this._synchOffset=0,this._prevPos=-1,this._prevPosition=0,this._t=0,this._framerate=egretAnimate.fps,this._duration=0,this._managed={},this.once(egret.Event.ADDED,function(){this._onAdded(),this.addEventListener(egret.Event.ADDED,this._onAdded,this),this.addEventListener(egret.Event.REMOVED,this._onRemoved,this)},this)};MovieClip.inited=!1,MovieClip.init=function(){MovieClip.inited||(MovieClipPlugin.install(),MovieClip.inited=!0)},MovieClip.INDEPENDENT="independent",MovieClip.SINGLE_FRAME="single",MovieClip.SYNCHED="synched";var p=MovieClip.prototype=Object.create(Container.prototype);DisplayObject.mixin(p),p.initialize=MovieClip,p._onAdded=function(){this.parent._isEgretAnimate||ticker.register(this._tickListener,this)},p._tickListener=function(tickerDeltaTime){var ms=tickerDeltaTime;this._tick(ms)},p._onRemoved=function(){this._tickListener},p.getLabels=function(){return this.timeline.getLabels()},p.getCurrentLabel=function(){return this._updateTimeline(),this.timeline.getCurrentLabel()};try{Object.defineProperties(p,{labels:{get:p.getLabels},currentLabel:{get:p.getCurrentLabel}})}catch(e){}Object.defineProperty(p,"elapsedTime",{get:function(){return this._t},set:function(value){this._t=value}}),Object.defineProperty(p,"framerate",{get:function(){return this._framerate},set:function(value){value>0?(this._framerate=value,this._duration=value?this.timeline.duration/value:0):this._framerate=this._duration=0}}),p.play=function(){this.paused=!1},p.stop=function(){this.paused=!0},p.gotoAndPlay=function(positionOrLabel){this.paused=!1,this._goto(positionOrLabel)},p.gotoAndStop=function(positionOrLabel){this.paused=!0,this._goto(positionOrLabel)},p.advance=function(time){var independent=MovieClip.INDEPENDENT;if(this.mode==independent){if(!this._framerate){for(var o=this,fps=o._framerate;(o=o.parent)&&!fps;)o.mode==independent&&(fps=o._framerate);this.framerate=fps}this.paused||(this._framerate>0?(time&&(this._t+=.001*time),this._t>this._duration&&(this._t=this.timeline.loop?this._t-this._duration:this._duration),this._prevPosition=Math.floor(this._t*this._framerate+1e-8),this._prevPosition>this.timeline.duration&&(this.timeline.loop?this._prevPosition=this._prevPosition%this.timeline.duration:this._prevPosition=this.timeline.duration)):this._prevPosition=this._prevPos<0?0:this._prevPosition+1)}},p._tick=function(delta){this.tickEnabled&&this.advance(delta),this._updateTimeline(),this.Container__tick(delta)},p.Container__tick=function(delta){if(this.tickChildren)for(var i=this.$children.length-1;i>=0;i--){var child=this.$children[i];child.tickEnabled&&child._tick?child._tick(delta):child.tickChildren&&child.Container__tick&&child.Container__tick(delta)}},p._goto=function(positionOrLabel){var pos=this.timeline.resolve(positionOrLabel);null!==pos&&pos!==undefined&&(this._prevPos==-1&&(this._prevPos=NaN),this._prevPosition=pos,this._framerate>0?this._t=pos/this._framerate:this._t=0,this._updateTimeline())},p._reset=function(){this._prevPos=-1,this._t=0,this.currentFrame=0},p._updateTimeline=function(){var tl=this.timeline,synched=this.mode!=MovieClip.INDEPENDENT;if(tl.loop=null==this.loop||this.loop,synched?tl.setPosition(this.startPosition+(this.mode==MovieClip.SINGLE_FRAME?0:this._synchOffset),Tween.NONE):tl.setPosition(this._prevPos<0?0:this._prevPosition,this.actionsEnabled?null:Tween.NONE),this._prevPosition=tl._prevPosition,this._prevPos!=tl._prevPos){this.currentFrame=this._prevPos=tl._prevPos;for(var n in this._managed)this._managed[n]=1;for(var tweens=tl._tweens,i=0,l=tweens.length;i<l;i++){var tween=tweens[i],target=tween._target;if(target!=this&&!tween.passive){var offset=tween._stepPosition;target instanceof egret.DisplayObject?this._addManagedChild(target,offset):this._setState(target.state,offset)}}var kids=this.$children;for(i=kids.length-1;i>=0;i--){var id=kids[i].id;1==this._managed[id]&&(this.removeChildAt(i),delete this._managed[id])}}},p._setState=function(state,offset){if(state)for(var i=state.length-1;i>=0;i--){var o=state[i],target=o.t,props=o.p;for(var n in props)target[n]=props[n];this._addManagedChild(target,offset)}},p._addManagedChild=function(child,offset){child._off||(this.addChildAt(child,0),child instanceof MovieClip&&(child._synchOffset=offset,child._updateTimeline(),child.mode==MovieClip.INDEPENDENT&&child.autoReset&&!this._managed[child.id]&&child._reset()),this._managed[child.id]=2)},p.__Container_destroy=p.destroy,p.destroy=function(destroyChildren){this._tickListener&&(ticker.unregister(this._tickListener,this),this._tickListener=null),this.__Container_destroy(destroyChildren)},egretAnimate.MovieClip=MovieClip,MovieClipPlugin.priority=100,MovieClipPlugin.install=function(){Tween.installPlugin(MovieClipPlugin,["startPosition"])},MovieClipPlugin.init=function(tween,prop,value){return value},MovieClipPlugin.step=function(){},MovieClipPlugin.tween=function(tween,prop,value,startValues,endValues,ratio,wait,end){return tween.target instanceof MovieClip?1==ratio?endValues[prop]:startValues[prop]:value}}(),function(undefined){var Container=egret.DisplayObjectContainer,EgretShape=egret.Shape,Graphics=egretAnimate.Graphics,DisplayObject=egretAnimate.DisplayObject,Shape=function(){EgretShape.call(this),Container.call(this),DisplayObject.call(this),this.$graphics=new Graphics,this.$graphics.$setTarget(this),this._maskUses=0},s=EgretShape.prototype,p=Shape.prototype=Object.create(s);DisplayObject.mixin(p),p.initialize=Shape,egretAnimate.Shape=Shape,p.destroy=function(recursive){this.graphics=null,s.destroy.call(this,recursive)}}(),function(undefined){var EgretText=egret.TextField,DisplayObject=egretAnimate.DisplayObject;utils=egretAnimate.utils;var Text=function(text,font,color){EgretText.call(this),DisplayObject.call(this),this.text=text,this.textColor=color&&utils.colorToHex(color),this.fontFamily=font.match(/'([a-zA-Z\ ]+)'/)[1],this.size=parseInt(font),this.type=egret.TextFieldType.DYNAMIC,this.addEventListener(egret.Event.ADDED,this._onTextAdded,this)},p=Text.prototype=Object.create(EgretText.prototype);p._onTextAdded=function(){this._originalX||(this._originalX=this.x),this.textAlign===egret.HorizontalAlign.CENTER&&(this.x=this._originalX+this.parent.nominalBounds.x,this.width=this.parent.nominalBounds.width)},Object.defineProperties(p,{lineHeight:{set:function(lineHeight){this.lineSpacing=lineHeight-this.size},get:function(){return this.lineSpacing}},lineWidth:{set:function(wordWrapWidth){this.textWidth>wordWrapWidth&&(this.wordWrap=!0,this.multiline=!0,this.width=wordWrapWidth)},get:function(){return this.$getWidth()}},shadow:{set:function(shadow){this.style.dropShadow=!!shadow,shadow&&(this.style.dropShadowColor=shadow.color)}}}),DisplayObject.mixin(p),p.initialize=Text,egretAnimate.Text=Text}();
